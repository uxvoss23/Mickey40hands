Perfect. Below is your Unified Gap-Fill Decision Model â€” clean, structured, and developer-ready.
This combines:

Time feasibility engine

Tier prioritization

Communication logic

Sequential outreach

Auto messages to all parties

Stop conditions

ğŸš€ UNIFIED GAP-FILL DECISION MODEL
1ï¸âƒ£ TRIGGER EVENT

Gap Fill Mode activates when:

A scheduled job is canceled

Tech presses: â€œRequest Nearby Jobâ€

System captures:

Current time

Current GPS

Next scheduled job window

Lateness tolerance (ex: +40 min)

Standard job duration (75 min)

Buffer (10 min)

Drive times

2ï¸âƒ£ HARD TIME FEASIBILITY GATE (Non-Negotiable)

A candidate is eligible ONLY if:

(Current Time
 + Drive to Candidate
 + 75 minutes
 + Drive to Next Job
 + 10 min buffer)
<= (Next Job Window Start + Lateness Tolerance)


If false â†’ skip candidate.

3ï¸âƒ£ MASTER TIER PRIORITY ORDER

System evaluates in this order:

ğŸ¥‡ TIER 1 â€“ Anytime Access

Required:

Quote accepted

Unscheduled

access_permission_type = ANYTIME_ACCESS

Time feasible

Sort:

Longest since last two-way interaction

Closest distance

Directional toward next job

Message:

â€œWeâ€™re working in your area and will be stopping by shortly to complete your cleaning unless we hear otherwise.â€

No confirmation required unless policy demands.

ğŸ¥ˆ TIER 2 â€“ Recurring Due / Overdue

Required:

Recurring (annual or bi-annual)

Within 7 days of due OR overdue

Not scheduled

Time feasible

Sort:

Most overdue

Longest since last interaction

Closest distance

Message:

â€œYouâ€™re coming up on your scheduled maintenance window and weâ€™re already nearby. We can complete your service today if convenient.â€

Sequential confirmation required.

ğŸ¥‰ TIER 3 â€“ Unscheduled + Flexible

Required:

Quote accepted

Unscheduled

Flexible = true OR today preferred

Time feasible

Not declined same-day in 6 months

Sort:

Longest since last interaction

Closest distance

Directional

Message:

â€œWe had a cancellation nearby and can fit you in today if that works.â€

Sequential confirmation required.

ğŸŸ¡ TIER 4 â€“ Scheduled (Pull Forward)

Required:

Scheduled within next 14 days

Time feasible

Sort:

Closest distance

Soonest scheduled date

Message:

â€œWe have an unexpected opening in your area today. If youâ€™d like to move your appointment forward, we can complete it this afternoon. Otherwise your current appointment remains unchanged.â€

ğŸŸ  TIER 5 â€“ Past Non-Recurring (Overdue)

Required:

â‰¥1 completed job

Recurring = NONE

Last service > 6 months

Not scheduled

Time feasible

Sort:

Most recently contacted first (responsive bias)

Largest service gap

Closest distance

Message:

â€œWeâ€™re working in your area and noticed itâ€™s been a while since your last cleaning. If youâ€™re due, we have an opening this afternoon.â€

4ï¸âƒ£ SEQUENTIAL OUTREACH ENGINE

Within active tier:

Select next eligible customer.

Send message.

Wait 60 seconds.

If no confirmation â†’ move to next.

Continue until:

Confirmation

20 total outreach attempts

Time feasibility fails

Tech cancels

5ï¸âƒ£ CONFIRMATION FLOW

When customer replies YES and tech presses â€œConfirmâ€:

System immediately:

Stops all outreach

Locks slot

Calculates ETA

Schedules 75-minute block

Updates CRM status

6ï¸âƒ£ AUTOMATED MESSAGES
ğŸ“© To Confirmed Customer

â€œThank you for being flexible â€” weâ€™re on the way now. Estimated arrival: [ETA].â€

ğŸ“© To Previously Contacted Customers

â€œThis opening has been filled. Your current appointment remains unchanged.â€

If Tier 4 pull-forward:
Insert original scheduled date automatically.

ğŸ“© Internal Notification to Tech

â€œSlot confirmed. Updated route sent.â€

7ï¸âƒ£ STOP CONDITIONS

System auto-stops if:

20 outreach attempts reached

Remaining time < 75 min + drive + buffer

Next job arrival cutoff at risk

Tech manually cancels

8ï¸âƒ£ DESIGN PHILOSOPHY

This engine prioritizes:

Protect next scheduled job

Lowest friction customers first

Route density optimization

Controlled escalation

No mass blasting

Automatic shutdown on confirmation